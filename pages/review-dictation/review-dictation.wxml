<view class="container">
  <view wx:if="{{isLoading}}" class="loading-message">
    <text>åŠ è½½å¤ä¹ å†…å®¹...</text>
  </view>
  <view wx:elif="{{!currentItem && dueItems.length > 0 && currentIndex >= dueItems.length}}" class="session-complete">
    <text class="complete-title">ğŸ‰ å¤ä¹ å®Œæˆ! ğŸ‰</text>
    <text>æœ¬æ¬¡æ‰€æœ‰å¤ä¹ ä»»åŠ¡å‡å·²å®Œæˆã€‚</text>
    <button type="primary" bindtap="goBackToHub">è¿”å›å¤ä¹ ä¸­å¿ƒ</button>
    <button type="default" bindtap="goBackToIndex">è¿”å›é¦–é¡µ</button>
  </view>
  <view wx:elif="{{!currentItem || dueItems.length === 0}}" class="no-items">
    <text>å½“å‰æ²¡æœ‰éœ€è¦å¤ä¹ çš„å†…å®¹ã€‚</text>
    <text wx:if="{{allItems.length > 0}}">æ‰€æœ‰å†…å®¹éƒ½å·²æŒæ¡æˆ–æœªåˆ°å¤ä¹ æ—¶é—´ã€‚</text>
    <text wx:else>è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•å­¦ä¹ å†…å®¹å“¦ã€‚</text>
    <button type="primary" bindtap="goBackToHub">è¿”å›å¤ä¹ ä¸­å¿ƒ</button>
  </view>

  <view wx:if="{{currentItem}}" class="dictation-card">
    <text class="progress-text">è¿›åº¦: {{currentIndex + 1}} / {{dueItems.length}}</text>
    <text class="item-type">{{currentItem.type === 'chinese' ? 'è¯­æ–‡' : 'è‹±è¯­'}}</text>

    <view class="prompt-section">
      <text class="prompt-label">è¯·æ ¹æ®æç¤ºå†™å‡º:</text>
      <text wx:if="{{currentItem.type === 'chinese' && currentItem.pinyin}}" class="prompt-text pinyin">{{currentItem.pinyin}}</text>
      <text wx:elif="{{currentItem.type === 'english' && currentItem.definition}}" class="prompt-text definition">{{currentItem.definition}}</text>
      <text wx:else class="prompt-text word-prompt">{{currentItem.word || currentItem.character || currentItem.phrase}}</text>
    </view>

    <input class="input-field"
           placeholder="åœ¨æ­¤è¾“å…¥ç­”æ¡ˆ"
           value="{{userInput}}"
           bindinput="handleInput"
           confirm-type="done"
           bindconfirm="submitAnswer"
           disabled="{{showAnswer}}" />

    <button type="primary" class="action-button" bindtap="submitAnswer" disabled="{{showAnswer || !userInput.trim()}}">æäº¤ç­”æ¡ˆ</button>

    <view wx:if="{{showAnswer}}" class="feedback-section">
      <text class="feedback-text {{feedback === 'æ­£ç¡®!' ? 'correct' : 'incorrect'}}">{{feedback}}</text>
      <text class="correct-answer-label">æ­£ç¡®ç­”æ¡ˆ:</text>
      <text class="correct-answer-text">{{ currentItem.type === 'chinese' ? (currentItem.character || currentItem.phrase) : currentItem.word }}</text>
      <button type="warn" class="action-button next-button" bindtap="nextItem">ä¸‹ä¸€ä¸ª</button>
    </view>
  </view>
</view>
